<!-- ** START template/system/logfile.html 13:16 20.12.2017 ************************************************************************** -->
<div data-role="page" id="main">
	<div data-role="header" id="warning">
		<h1><TMPL_VAR LOGVIEWER.WIDGETLABEL></h1>
	</div>
  <!-- content -->
	<div data-role="content" role="main" class="ui-content">
		<div class="ui-body ui-body-a ui-corner-all loxberry-logo">
		<!-- text -->
			<div style="margin: 2%">
				
				<TMPL_IF NOLOGPARAMETER>
					<center>
					<div style="width:60%" class="logerror">
						<p><TMPL_VAR LOGVIEWER.ERR_MISSING_LOGPARAMETER_HTML></p>
					</div>
					</center>
				</TMPL_IF>
				<TMPL_IF NOLOGFILE>
					<center>
					<div style="width:60%" class="logerror">
						<p><TMPL_VAR LOGVIEWER.ERR_NOLOG_HTML></p>
					</div>
					</center>
				<TMPL_ELSE>
					<!-- <div style="width:100%; height:57vh;"> -->
					<div style="width:100%; height:60vh; background-color: transparent; font-family:monospace; color:#8080FF; overflow-y: scroll" id="Logfile" contenteditable="true">
					</div>
					<!-- </div> -->
					<table width="100%" border="0">
						<tr>
							<td width="100%">
								<a id="btnnext" data-role="button" data-inline="true" data-mini="true" data-icon="check" href="javascript:window.close()">Close</a>
							</td>
							<td>
								<label style="display:block; text-align:center; width:60px; height: 15px; font-size:11;"><input data-mini="true" type="checkbox" checked id="LogScroll">Autoscroll</label>
							</td>
							<td>
								<a style="display:block; text-align:center; width:60px; height: 14px; font-size:11;" id="btndown" data-role="button" data-inline="true" data-mini="true" data-icon="arrow-d" href="/admin/system/tools/logfile.cgi?logfile=<TMPL_VAR LOGFILE>&header=txt&format=plain" target="_blank">Download</a>
							</td>
						</tr>
					</table>
<script>

function updatelog() 
	{
		// Disable caching of AJAX responses
		$.ajaxSetup (
		{
			cache: false
		});
		// Load Logfile
		$('#Logfile').load('/admin/system/tools/logfile.cgi?logfile=<TMPL_VAR LOGFILE>&head=none&format=html');
		if ($("#LogScroll").is(":checked"))
		{
			$("#Logfile").scrollTop($("#Logfile")[0].scrollHeight);
		}
		return;
	}
var interval = window.setInterval(updatelog, 1000);

$("#Logfile").click(function() {
		clearInterval(interval);
		$("input[type='checkbox']").attr("checked",false).checkboxradio("refresh");
});

$("#LogScroll").click(function() {
		if ( $(this).is(':checked') ) {
			$("#Logfile").scrollTop($("#Logfile")[0].scrollHeight).delay(100);
			interval = window.setInterval(updatelog, 1000);
		} else {
			clearInterval(interval);
		}
});

/*
$("#Logfile").scroll(function() {
	console.log("ScrollTop:", $("#Logfile").scrollTop);
	clearInterval(interval);
	$("input[type='checkbox']").attr("checked",false).checkboxradio("refresh");
});
*/


</script>
				</TMPL_IF>
				
			</div>
		</div>
	</div>
</div>